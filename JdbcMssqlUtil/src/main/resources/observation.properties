1=select convert( varchar, format(avg(call_cost),''N2'') ) from ic360.tmsdata td join ic360.source s on td.source_id = s.source_id where direction ilike ''O'' {filterWhereClause}
2=select top 1 convert(varchar,format(max(call_cost),''N2'') )  + '' by '' + label FROM ic360.tmsdata td JOIN ic360.source s on (td.source_id = s.source_id) WHERE lower(direction) like ''o''  {filterWhereClause} group by label order by max(call_cost) DESC
3=SELECT top 1 (cast(substring(convert (varchar(23),Dateadd(s, ceiling(max(duration)), LEFT(getdate(),11)),121),12,8) as time))  + '' from '' + label FROM ic360.tmsdata td JOIN ic360.source s on (td.source_id = s.source_id) WHERE 	unanswer = ''0'' {filterWhereClause} group by label order by max(duration) DESC 
4=SELECT  (cast(substring(convert (varchar(23),Dateadd(s, ceiling(avg(duration)), LEFT(getdate(),11)),121),12,8) as time)) FROM ic360.tmsdata td JOIN ic360.source s on (td.source_id = s.source_id) WHERE unanswer = ''0'' {filterWhereClause} 
5=select count(*) from ic360.tmsdata td join ic360.source s on td.source_id = s.source_id where unanswer = ''1'' and lower(direction) like ''i'' {filterWhereClause} 
6=select top 1 billref.reference1 + '' '' + label + '' with '' + count(billref.reference1) + '' calls'' FROM  ic360.tmsdata td	join ic360.source s on td.source_id = s.source_id join ic360.billref br on (s.billref_id = br.id) where lower(direction) like ''o'' {filterWhereClause} group by br.reference1,label order by count(br.reference1) desc
11=select COUNT(DISTINCT billref.id) + '' with a cost of &#163;'' + convert(varchar, format( sum(pretax_cost),''N2'') ) 	FROM  ic360.carrier_summary as carrier_detail join ic360.carrier_summary_category csc on (carrier_detail.cat_id = csc.cat_id), ic360.SOURCE, ic360.INVOICE, ic360.BILLREF, ic360.CATEGORY_GROUP, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and carrier_detail.source_id = source.source_id AND invoice.invoice_id = carrier_detail.invoice_id  AND billref.id = source.billref_id AND carrier_summary_category.group_id = category_group.group_id AND billref.reference2 NOT LIKE ''WM%'' AND carrier_detail.source_id NOT IN (select DISTINCT carrier_detail.source_id from ic360.carrier_detail where carrier_detail.invoice_id in ({periodInvoiceIds})) AND pretax_cost <> 0 AND carrier_summary_category.group_id != 1 {filterWhereClause}
12=select convert(varchar,format(SUM(pretax_cost),''N2'') from (select source_id,invoice_id, case when group_id = 3 then sum(pretax_cost) else 0 end as pretax_cost from ic360.carrier_summary cs join ic360.carrier_summary_category csc on (cs.cat_id = csc.cat_id) group by group_id ,source_id,invoice_id  ) as carrier_detail, ic360.invoice, ic360.source, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and carrier_detail.invoice_id = invoice.invoice_id and source.source_id = carrier_detail.source_id {filterWhereClause} 
13=select convert(varchar,format(SUM(pretax_cost),''N2'')) from (select cat_id, source_id,invoice_id, case when cat_id in (38) then sum(pretax_cost) else 0 end as pretax_cost from ic360.carrier_summary group by cat_id, source_id,invoice_id ) as carrier_detail, ic360.invoice, ic360.source, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and carrier_detail.invoice_id = invoice.invoice_id and source.source_id = carrier_detail.source_id {filterWhereClause}
15=SELECT count(distinct carrier_detail.source_id) FROM ic360.carrier_summary as carrier_detail, ic360.invoice, ic360.source, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and carrier_detail.invoice_id = invoice.invoice_id and source.source_id = carrier_detail.source_id {filterWhereClause} 
16=select top 1 convert(varchar, format(coalesce(max(cost),0),''N2'' )) + '' by '' + label + '' to '' + destcli from ic360.carrier_detail,ic360.SOURCE,ic360.INVOICE, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and INVOICE.INVOICE_ID = carrier_detail.INVOICE_ID AND carrier_detail.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause} GROUP BY destcli, label ORDER BY max(cost) DESC 					
17=select top 1 destcli + '' has been dialled '' + count(*) + '' times for a total of '' + convert(varchar, format(COALESCE(ROUND(SUM(cast(call_duration as double precision)) / 60.00,0),0),''N2'') ) + '' minutes and a cost of &#163;'' + convert(varchar,format(SUM(cost),''N2'')) from ic360.carrier_detail,ic360.SOURCE,ic360.INVOICE, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and INVOICE.INVOICE_ID = carrier_detail.INVOICE_ID AND carrier_detail.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause} GROUP BY destcli ORDER BY count(*) DESC 
21=SELECT TRIM(convert(varchar,format(COALESCE(avg(cost),0),''N2'') )) + '' with an average duration of '' + convert(varchar,format(COALESCE(avg(duration),0) / 60.00,''N0'') ) + '' minutes'' FROM ic360.mobile,ic360.tabella_b, ic360.invoice  JOIN ic360.account  on (invoice.account_id = account.account_id) join ic360.carrier on (account.carrier_id = carrier.carrier_id) ,ic360.source, ic360.billref where billref.id = source.billref_id and mobile.invoice_id = invoice.invoice_id and ( group_category_id = 1 or class_id IN (9,10,11,33) )and tabella_b.id = mobile.category_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause}
22=select convert(varchar,format(COALESCE(avg(duration),0) / 60.00,''N0'')) + '' minutes'' from ic360.MOBILE,ic360.SOURCE,ic360.invoice, ic360.tabella_b, ic360.BILLREF, ic360.account, ic360.carrier WHERE invoice.account_id = account.account_id and account.carrier_id = carrier.carrier_id and BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and ( group_category_id = 1 or class_id IN (9,10,11,33) ) and tabella_b.id = mobile.category_id  and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause}
23=select top 1 TRIM(convert(varchar,format(coalesce(cost,0),''N2''))) + '' by '' + label + '' with a call type of '' + mobile.description from ic360.invoice  JOIN ic360.account  on (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id),ic360.MOBILE,ic360.SOURCE, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID  {filterWhereClause} order by cost desc 
24=SELECT top 1 convert(varchar,format(COALESCE(ROUND(duration / 60.00,0),0),''N0'')) + '' minutes by '' + label + '' with a cost of &#163;'' + TRIM(convert(varchar,format(coalesce(cost,0),''N2'')))  from ic360.invoice JOIN ic360.account on (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id), ic360.MOBILE,ic360.SOURCE,ic360.tabella_b, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and ( group_category_id = 1 or class_id IN (9,10,11,33) ) and tabella_b.id = mobile.category_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause} order by duration desc 	
25=select top 1 convert(varchar,format(coalesce(max(lngcallcharges),0),''N2''))  + '' by '' + label from ic360.invoice JOIN ic360.account ON (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id),ic360.SOURCE, ic360.summary_handset, ic360.mobile, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and mobile.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause} group by label order by max(lngcallcharges) desc 
26=SELECT convert(varchar,format(COALESCE(ROUND(SUM(duration) / 60.00,0),0),''N0'')) + '' minutes'' FROM ic360.invoice JOIN ic360.account on (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id), ic360.mobile, ic360.tabella_b, ic360.SOURCE, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and class_id IN (14,17,31) and tabella_b.id = mobile.category_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause}
27=SELECT TRIM(convert(varchar,format(coalesce(SUM(cost),0),''N2''))) FROM ic360.invoice JOIN ic360.account on (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id),ic360.mobile,ic360.tabella_b, ic360.SOURCE, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and group_category_id = 4 and tabella_b.id = mobile.category_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause}
28=SELECT convert(varchar,format(COALESCE(count(*),0),''N0'')) FROM ic360.invoice JOIN ic360.account on (invoice.account_id = account.account_id) JOIN ic360.carrier on (account.carrier_id = carrier.carrier_id),ic360.mobile,ic360.tabella_b, ic360.SOURCE, ic360.BILLREF WHERE BILLREF.id = SOURCE.billref_id and mobile.invoice_id = invoice.invoice_id and bundle = 1 and group_category_id = 2 AND tabella_b.id = mobile.category_id and MOBILE.SOURCE_ID = SOURCE.SOURCE_ID {filterWhereClause}
31=select top 1 convert(varchar,format(count(*),''######'')) from ic360.employee e join ic360.source s on (e.employee_id = s.employee_id) WHERE username = ''unknown.user'' {filterWhereClause} group by employee_id, givenname,surname order by count(*) DESC 
32=select top 1 givenname + '' '' + surname + '' with '' + convert(varchar,format(count(*),''######'')) from ic360.employee e join ic360.source s on (e.employee_id = s.employee_id) WHERE username != ''unknown.user'' {filterWhereClause} group by employee.employee_id, givenname,surname order by count(*) DESC 
41=select count(distinct employee_id) FROM (select distinct pcm.employee_id from ic360.source, ic360.pcm_submission pcm, ic360.summary_handset shi, ic360.invoice where convert(varchar,FORMAT( pcm.period_date, ''MMM yy'', ''en-US'' )) = convert(varchar,FORMAT( invoice.invoice_date, ''MMM yy'', ''en-US'' )) and pcm.source_id = shi.source_id and shi.source_id = source.source_id and project_id = CASE WHEN project_id = 2 and cost > 0 THEN project_id ELSE 0 END {filterWhereClause} except select distinct pcm.employee_id from ic360.source, ic360.pcm_submission pcm, ic360.summary_handset shi, ic360.invoice where convert(varchar,FORMAT( pcm.period_date, ''MMM yy'', ''en-US'' )) = convert(varchar,FORMAT( invoice.invoice_date, ''MMM yy'', ''en-US'' )) and pcm.source_id = shi.source_id and shi.source_id = source.source_id and project_id = CASE WHEN project_id = 1 and cost > 0 THEN project_id ELSE 0 END {filterWhereClause}) as t
42=SELECT trim(convert(varchar,format(SUM(duration)/ 60,''###,###,###''))) as sumcalltime from ic360.mobile,ic360.source, ic360.invoice WHERE mobile.invoice_id = invoice.invoice_id AND source.source_id = mobile.source_id and blnweekday = ''1'' and project_id = 1 and calltime > (select convert(numeric,format(value,''#####'')) from system where name = ''start_time'') and calltime < (select convert(numeric,format(value,''#####'')) from system where name = ''end_time'') {filterWhereClause}
43=SELECT trim(convert(varchar,format(SUM(duration)/ 60,''###,###,###''))) as sumcalltime from ic360.mobile,ic360.source, ic360.invoice WHERE invoice.invoice_id = mobile.invoice_id AND source.source_id = mobile.source_id and project_id = 2 and (blnweekday = ''1'' and (calltime < (select convert(numeric,format(value,''#####'')) from system where name = ''start_time'') or calltime > (select convert(numeric,format(value,''#####'')) from system where name = ''end_time'')) or blnweekday = ''0'') {filterWhereClause}
44=select count (distinct employeepcm.cli) from ic360.employeepcm, ic360.mobile, ic360.source, ic360.employee, ic360.invoice where invoice.invoice_id = mobile.invoice_id AND employeepcm.cli = mobile.destcli and mobile.source_id = source.source_id and source.source_id = employeepcm.user_id and source.employee_id = employee.employee_id and mobile.project_id = 2 and employeepcm.cli not in (select cli from ic360.globalpcm) {filterWhereClause}
51=SELECT convert(varchar,format(avg(pocost),''N2'')) FROM ic360.asset a,ic360.product p,ic360.assetemployee ae,ic360.employeelevel el,ic360.level l WHERE pocost > 0  and a.product_id = p.product_id and a.asset_id = ae.asset_id and ae.employee_id = el.employee_id and el.level_id = l.level_id and (case when {ltf_chosen_1} > 0 then l.level_id = {ltf_chosen_1} else l.strata_id = (-1*{ltf_chosen_1}) end) and ae.date_relocated >= DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0) and ae.date_assigned < DATEADD(month, DATEDIFF(month, 0, DATEADD(month, 1, DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0))), 0)
52=SELECT convert(varchar,format(sum(pocost)/(select Count(1) from ic360.employee),''N2'')) FROM ic360.asset a,ic360.product p,ic360.assetemployee ae,ic360.employeelevel el, ic360.level l WHERE pocost > 0 and a.product_id = p.product_id and a.asset_id = ae.asset_id and ae.employee_id = el.employee_id and el.level_id = l.level_id and (case when {ltf_chosen_1} > 0 then l.level_id = {ltf_chosen_1} else l.strata_id = (-1*{ltf_chosen_1}) end) and ae.date_relocated >= DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0) and ae.date_assigned < DATEADD(month, DATEDIFF(month, 0, DATEADD(month, 1, DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0))), 0)	
53=select count(1) from (SELECT ae.employee_id,count(1) as c FROM ic360.asset a,ic360.product p,ic360.assetemployee ae,ic360.employeelevel el,ic360.level l WHERE pocost > 0 and a.product_id = p.product_id and a.asset_id = ae.asset_id and ae.employee_id = el.employee_id and el.level_id = l.level_id and (case when {ltf_chosen_1} > 0 then l.level_id = {ltf_chosen_1} else l.strata_id = (-1*{ltf_chosen_1}) end) and ae.date_relocated >= DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0) and ae.date_assigned < DATEADD(month, DATEDIFF(month, 0, DATEADD(month, 1, DATEADD(month, DATEDIFF(month, 0, DATEADD(month, {focus_index} * -1, GETDATE()) ), 0))), 0) group by ae.employee_id) as ct where ct.c>1
61=SELECT convert(varchar,format(max(claim_total / 100),''N2'')) from ic360.expensedata, ic360.source, ic360.invoice WHERE source.source_id = expensedata.source_id and expensedata.invoice_id = invoice.invoice_id and expense_disc_id =5 {filterWhereClause} and INVOICE_DATE >= ''{from_invoice_month_year}-{from_invoice_month}-01'' and INVOICE_DATE <= ''{from_invoice_month_year}-{from_invoice_month}-{from_invoice_month_days}''
62=select count(*) from ic360.expensedata, ic360.expense_desc, ic360.source, ic360.invoice WHERE source.source_id = expensedata.source_id and expensedata.expense_disc_id = expense_desc.exp_disc_id and expensedata.invoice_id = invoice.invoice_id and exp_gp_id = 3 and claim_total > 15000 {filterWhereClause} and INVOICE_DATE >= ''{from_invoice_month_year}-{from_invoice_month}-01'' and INVOICE_DATE <= ''{from_invoice_month_year}-{from_invoice_month}-{from_invoice_month_days}''
63=select count(*) from ic360.expensedata, ic360.expense_desc, ic360.source, ic360.invoice WHERE source.source_id = expensedata.source_id and	expensedata.expense_disc_id = expense_desc.exp_disc_id and expensedata.invoice_id = invoice.invoice_id and exp_gp_id = 1 and claim_total > 15000 {filterWhereClause} and INVOICE_DATE >= ''{from_invoice_month_year}-{from_invoice_month}-01'' and INVOICE_DATE <= ''{from_invoice_month_year}-{from_invoice_month}-{from_invoice_month_days}''
71=select top 1 cast(netamount as varchar) + '' by '' + (select coalesce(givenname,'''')|| '' '' || coalesce(surname,'''') from ic360.employee where source.employee_id = employee_id) from (select source_id, sum(net_amount) netamount, invoice_id from ic360.fuel_detail group by source_id, invoice_id) as t, ic360.source, ic360.invoice, ic360.account, ic360.carrier where t.source_id = source.source_id and invoice.invoice_id = t.invoice_id and invoice.account_id = account.account_id and carrier.carrier_id = account.carrier_id {filterWhereClause} order by netamount desc 
72=select top 1 convert(varchar,format(mile,''###,###,###'')) + '' by '' + (select coalesce(givenname,'''')+ '' '' + coalesce(surname,'''') from ic360.employee where source.employee_id = employee_id) from (select source_id, max(cast(transaction_mileage_amount as numeric)) - min(cast(transaction_mileage_amount as numeric)) as mile, invoice_id from ic360.fuel_detail group by source_id, invoice_id) as t, ic360.source, ic360.invoice, ic360.account, ic360.carrier where t.source_id = source.source_id and invoice.invoice_id = t.invoice_id and invoice.account_id = account.account_id and carrier.carrier_id = account.carrier_id {filterWhereClause} order by mile desc 
73=select round(avg(unit_price),3) from ic360.fuel_detail d, ic360.fuel_product p, ic360.source, ic360.invoice, ic360.account, ic360.carrier where d.source_id = source.source_id and d.product_id = p.id and invoice.invoice_id = d.invoice_id and invoice.account_id = account.account_id and carrier.carrier_id = account.carrier_id and lower(p.description) like ''%unleaded%'' {filterWhereClause}
74=select round(avg(unit_price),3) from ic360.fuel_detail d, ic360.fuel_product p, ic360.source, ic360.invoice, ic360.account, ic360.carrier where d.source_id = source.source_id and d.product_id = p.id and invoice.invoice_id = d.invoice_id and invoice.account_id = account.account_id and carrier.carrier_id = account.carrier_id and lower(p.description) like ''%unleaded%'' {filterWhereClause}
81=SELECT convert(varchar,format(count(*),''########'')) + '' conferences where only 1 party connected totalling '' + convert(varchar,format(datepart( hh,cast(substring(convert (varchar(23),Dateadd(s, sum(duration), LEFT(getdate(),11)),121),12,8) as time) ),''######'')) + '' hours and &#163;'' + convert(varchar,format(sum(call_amount),''#######'')) from ic360.conf_summary cs JOIN ic360.conf_category cc on (cs.conf_category_id = cc.conf_category_id) join ic360.conf_group_category cgc on (cc.conf_group_category_id = cgc.conf_group_category_id) JOIN ic360.category_group ON (group_id=category_group_id) JOIN ic360.source s on (cs.source_id = s.source_id) JOIN ic360.employee e on (s.employee_id = e.employee_id) WHERE conf_group_category_id = 2 and actual_connection = 1 and invoice_id in (SELECT invoice_id FROM ic360.invoice WHERE invoice_date between ''{from_date}'' and ''{to_date}'') {filterWhereClause}
82=SELECT convert(varchar,format(count(*),''########'')) + '' conferences where only 2 parties connected totalling '' + convert(varchar,format(datepart( hh,cast(substring(convert (varchar(23),Dateadd(s, sum(duration), LEFT(getdate(),11)),121),12,8) as time) ),''######'')) + '' hours and &#163;'' + convert(varchar,format(sum(call_amount),''#######'')) from ic360.conf_summary cs JOIN ic360.conf_category cc on (cs.conf_category_id = cc.conf_category_id) join ic360.conf_group_category cgc on (cc.conf_group_category_id = cgc.conf_group_category_id) JOIN ic360.category_group ON (group_id=category_group_id) JOIN ic360.source s on (cs.source_id = s.source_id) JOIN ic360.employee e on (s.employee_id = e.employee_id) WHERE conf_group_category_id = 2 and actual_connection = 2 and invoice_id in (SELECT invoice_id FROM ic360.invoice WHERE invoice_date between ''{from_date}'' and ''{to_date}'') {filterWhereClause}
90=select count(*) from (select source_id, count(level_id) from ic360.billref left join ic360.sourcelevel on(sourcelevel.source_id=billref.source_id) where billref.module_id = 2 group by billref.source_id having count(level_id) = 0) as unassigned
91=select count(*) from (select source_id, count(level_id) from ic360.billref left join ic360.sourcelevel on(sourcelevel.source_id=billref.source_id)  where billref.module_id = 1 group by billref.source_id having count(level_id) = 0) as unassigned	
92=select count(*) from (select source_id, count(level_id) from ic360.billref left join ic360.sourcelevel on(sourcelevel.source_id=billref.source_id) where billref.module_id = 0 group by billref.source_id having count(level_id) = 0) as unassigned
93=select count(*) from (select surname + '', '' + givenname, count(source_id) from ic360.employee left join ic360.source on (source.employee_id=employee.employee_id)  group by employee_id, surname, givenname having count(source_id) = 0 ) as employees	
94=select count(*) from ic360.source where 0 = employee_id and DATEDIFF( MM, billref_assigned, GETDATE()) < 3